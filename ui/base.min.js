function exportfreeplaces(){$("#load").modal("show");var e="data:text/csv;charset=utf-8,";e+="storageLocationId;storageLocationName\n",$.each(returnfreeplaces("2"),function(t,a){e+=a[0]+";"+a[1]+"\n"});var t=encodeURI(e),a=document.createElement("a");a.setAttribute("href",t),a.setAttribute("download","export.csv"),document.body.appendChild(a),a.click(),$("#load").modal("hide")}function generatePdf(){var e=new jsPDF("p","pt"),t=["StorageLocationId","StorageLocationName"],a=[],r=0;$.each(returnfreeplaces(2),function(){a[r]=this,r++}),e.autoTable(t,a,{theme:"striped",bodyStyles:{lineColor:1,lineWidth:1},headerStyles:{lineColor:1,lineWidth:1,fillColor:1,textColor:500}}),e.save("FreePlaces.pdf")}function getfreeplaces(){filledplaces={},freeplaces={},places={};(zones={}).Alle="Alle",$.ajax({type:"GET",url:"/rest/stockmanagement/warehouses/1/stock/storageLocations",headers:{Authorization:"Bearer "+localStorage.getItem("accessToken")},data:{itemsPerPage:"9999999"},success:function(e){$.each(e.entries,function(){if(this.quantity>0){if(this.storageLocationId<=12140)return!0;filledplaces[this.storageLocationId]={},filledplaces[this.storageLocationId]=1}});$.ajax({type:"GET",url:"/rest/stockmanagement/warehouses/1/management/storageLocations",headers:{Authorization:"Bearer "+localStorage.getItem("accessToken")},data:{itemsPerPage:"9999999"},success:function(e){$.each(e.entries,function(){if(this.id<=12140)return!0;places[this.id]={},places[this.id]={name:this.name,type:this.type,rack:this.rackId,shelf:this.shelfId}}),$.each(places,function(e,t){if(void 0!==filledplaces[e]);else{freeplaces[e]={},freeplaces[e]=t;var a=t.name.split("-");zones[a[0]]=a[0]}})}})}})}function returnfreeplaces(e){if(void 0==e)var e=0;if(Object.keys(places).length>0){var t=$("#freeplaceslimit").val(),a=$("#zoneSelect").val(),r=0,o=0,s="<table class='table table-striped table-bordered'><th>storageLocationId</th><th>storageLocationName</th>",n={};return $.each(freeplaces,function(e,i){return!(r>=t)&&("Alle"!=a&&-1==i.name.indexOf(a)||(r++,o++,s=s+"<tr><td>"+e+"</td><td>"+i.name+"</td></tr>",n[o]={},void(n[o]=[e,i.name])))}),s+="</table>","0"==e&&(o>0?$("#freeplacesausgabe").html(s):$("#freeplacesausgabe").html("<hr><p style='color: red;'>Keine Lagerorte gefunden.</p>")),"1"==e?(s=s.replace("<table","<table style='border-spacing: 2px !important;' "),s=s.replace("<td","<td style='padding: 2px;' ")):n}alert("Bitte berechnen Sie zuerst Ihre freien Lagerorte")}function togglefreielagerorte(){$("#freeplacesdialog").dialog("open")}function deletefreeplace(e){delete freeplaces[e],returnfreeplaces()}var warehouses={},filledplaces={},places={},freeplaces={},zones={},calced=0,userId=0;$(document).ready(function(){$(document).ajaxStart(function(){$("#error_body").html(""),$("#load").modal("show")}).ajaxStop(function(){$("#load").modal("hide")}).ajaxError(function(e){var t=$.parseJSON(e.responseText);$("#error_body").append("<div class='find-false'><p>ErrorCode: "+t.error.code+" <br/> Message: "+t.error.message+"</p></div>"),$("#error_modal").modal("show")}),getfreeplaces(),$(".showplaces").click(function(){returnfreeplaces()}),$(".calcplaces").click(function(){getfreeplaces()}),$(".export").click(function(){exportfreeplaces()}),$(".pdf").click(function(){generatePdf()}),setInterval(function(){switch($("#loadingpins").attr("pins")){case"0":$("#loadingpins").text("."),$("#loadingpins").attr("pins","1");break;case"1":$("#loadingpins").text(".."),$("#loadingpins").attr("pins","2");break;case"2":$("#loadingpins").text("..."),$("#loadingpins").attr("pins","3");break;case"3":$("#loadingpins").text("...."),$("#loadingpins").attr("pins","0")}},500),setTimeout(function(){$(".ueberschnittmessage").fadeOut(250)},7500)});