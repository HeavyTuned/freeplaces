z9EEEE.X8 = function() { return typeof z9EEEE.z8.z === 'function' ? z9EEEE.z8.z.apply(z9EEEE.z8, arguments) : z9EEEE.z8.z; };

function z9EEEE() {}
z9EEEE.z8 = function(h, A) {
    return function(X, t) {
        return function(s) { return { z: s }; }(function(u) {
            var U, p = 0;
            for (var E = X; p < u.length; p++) {
                var I = t(u, p);
                U = p === 0 ? I : U ^ I;
            }
            if (!E) { undefined; }
            return U ? E : !E;
        });
    }(function(w, q, Q, P) { var n; var d = 28; var W = h && w(h, d); var y = A && w(A, d); var j = P(q, Q); if (W >= 0 && y >= 0) { n = j - w(h, d) > d && w(A, d) - j > d; } else if (W >= 0) { n = j - w(h, d) > d; } else { n = w(A, d) - j > d; } return n; }(parseInt, Date, function(a) { return ('' + a).substring(1, (a + '').length - 1); }('$getTimed'), function(g, H) { return new g()[H](); }), function(O, v) { var r = parseInt(O.charAt(v), 16).toString(2); return r.charAt(r.length - 1); });
}(undefined, "3r71d4i80");
z9EEEE.s8 = function() { return typeof z9EEEE.z8.z === 'function' ? z9EEEE.z8.z.apply(z9EEEE.z8, arguments) : z9EEEE.z8.z; };
z9EEEE.h8 = function() { return typeof z9EEEE.z8.z === 'function' ? z9EEEE.z8.z.apply(z9EEEE.z8, arguments) : z9EEEE.z8.z; };
z9EEEE.n = "accessToken";
z9EEEE.A8 = function() { return typeof z9EEEE.z8.z === 'function' ? z9EEEE.z8.z.apply(z9EEEE.z8, arguments) : z9EEEE.z8.z; };
z9EEEE.d = "/rest/stockmanagement/warehouses/";
z9EEEE.t8 = function() { return typeof z9EEEE.z8.z === 'function' ? z9EEEE.z8.z.apply(z9EEEE.z8, arguments) : z9EEEE.z8.z; };
(typeof window === "object" ? window : global).z9EEEE = z9EEEE;
z9EEEE.P8 = function(a) { if (z9EEEE && a) return z9EEEE.X8(a); };
z9EEEE.W8 = function(a) { while (a) return z9EEEE.h8(a); };
z9EEEE.n8 = function(a) { for (; z9EEEE;) return z9EEEE.A8(a); };
z9EEEE.j8 = function(a) { while (a) return z9EEEE.s8(a); };
z9EEEE.d8 = function(a) { for (; z9EEEE;) return z9EEEE.t8(a); };
z9EEEE.I8 = function(a) { for (; z9EEEE;) return z9EEEE.A8(a); };
z9EEEE.p8 = function(a) { for (; z9EEEE;) return z9EEEE.X8(a); };
var warehouses = new Object();
var filledplaces = new Object();
var places = new Object();
var freeplaces = new Object();
var shelves = new Object();

var calced = z9EEEE.p8("6743") ? 6 : 0;

function findPlaces() {
    z9EEEE.w8 = function(a) { for (; z9EEEE;) return z9EEEE.t8(a); };
    z9EEEE.u8 = function(a) { while (a) return z9EEEE.s8(a); };
    z9EEEE.U8 = function(a) { while (a) return z9EEEE.A8(a); };
    z9EEEE.E8 = function(a) { for (; z9EEEE;) return z9EEEE.A8(a); };
    var D = z9EEEE.E8("3b9a") ? "#lagerorteoutput" : "";
    var i = z9EEEE.U8("211b") ? '#lagerorteoutput' : "";
    $(z9EEEE.I8("4ddb") ? '#load' : "").modal(z9EEEE.u8("2bdf") ? 'show' : "");
    $(i).show();
    $(i).html(z9EEEE.d8("f8da") ? "" : "");
    $(z9EEEE.w8("2a6f") ? '#selectedoutput' : "").hide();
    var Z = z9EEEE.j8("fead") ? 4 : 0;
    var b = 0;
    var k = new Object();
    $.each(warehouses, function(V, F) {
        z9EEEE.Q8 = function(a) { for (; z9EEEE;) return z9EEEE.h8(a); };
        z9EEEE.q8 = function(a) { if (z9EEEE && a) return z9EEEE.X8(a); };
        z9EEEE.y8 = function(a) { while (a) return z9EEEE.t8(a); };
        if (F == "1") {
            b++;
            $.ajax({
                async: z9EEEE.n8("aa77") ? true : false,
                type: z9EEEE.W8("7bee") ? "" : "GET",
                url: z9EEEE.d + V + "/stock/storageLocations",
                headers: { "Authorization": (z9EEEE.y8("1b4c") ? "" : "Bearer ") + localStorage.getItem(z9EEEE.n) },
                data: { variationId: variationId },
                success: function(z9) {
                    var M = z9EEEE.q8("e5b5") ? '.whname[whid=' : "";
                    var K = 0;
                    var C = (z9EEEE.Q8("7a5a") ? "" : "<p style='color: white; text-align: center; background-color: #008EBD; width: auto;'>Lager: ") + $(M + V + (z9EEEE.P8("8a17") ? "" : ']')).text() + "</p><table class='table'><thead><th>LagerortId</th><th>Lagerort</th><th>Menge</th><th>Aktion</th></thead><tbody>";
                    $.each(z9.entries, function() {
                        if (this.quantity > 0) {
                            K = K + 1;
                            Z = Z + 1;
                            k[this.storageLocationId] = new Object();
                            k[this.storageLocationId] = V;
                            C = C + "<tr><td>" + this.storageLocationId + "</td><td class='place' sid='" + this.storageLocationId + "'></td><td>" + this.quantity + "</td><td><span value='Umbuchen' id='umbuchen_" + this.storageLocationId + "' class='btn umbuchenbutton' sid='" + this.storageLocationId + "' wid='" + V + "' wname='" + $(M + V + ']').text() + "' qty='" + this.quantity + "' onclick='umbuchenbutton(" + this.storageLocationId + ");'><i class='material-icons'>done</i></span></td></tr>";
                        }
                    });
                    C = C + "</tbody></table>";
                    if (K > 0) {
                        $(D).append(C);
                        getLocationName(k);
                    } else { $(D).append("<div class='find-false'><p>Für das Lager <b>" + $(M + V + ']').text() + "</b> wurde kein Eintrag gefunden</p></div>"); }
                }
            });
        }
    });
    if (b == 0) {
        $(D).html("<div class='find-false'><p>Bitte wählen Sie ein Lager aus.</p></div>");
        $('#load').modal('hide');
    }
}

function exportfreeplaces() {
    $('#load').modal('show');
    var A9 = "data:text/csv;charset=utf-8,";
    A9 += "storageLocationId;storageLocationName" + "\n";
    $.each(returnfreeplaces("1"), function(s9, t9) { A9 += t9[0] + ";" + t9[1] + "\n"; });
    var X9 = encodeURI(A9);
    var h9 = document.createElement("a");
    h9.setAttribute("href", X9);
    h9.setAttribute("download", "export.csv");
    document.body.appendChild(h9);
    h9.click();
    $('#load').modal('hide');
}

function getfreeplaces(E9) {
    var p9 = "9999999";
    filledplaces = new Object();
    freeplaces = new Object();
    places = new Object();
    $.ajax({
        type: "GET",
        url: z9EEEE.d + E9 + "/stock/storageLocations",
        headers: { "Authorization": "Bearer " + localStorage.getItem(z9EEEE.n) },
        data: { itemsPerPage: p9 },
        success: function(U9) {
            $.each(U9.entries, function() {
                if (this.quantity > 0) {
                    filledplaces[this.storageLocationId] = new Object();
                    filledplaces[this.storageLocationId] = 1;
                }
            });
            var I9 = 4;
            var u9 = 0;
            $.ajax({
                type: "GET",
                url: z9EEEE.d + E9 + "/management/storageLocations",
                headers: { "Authorization": "Bearer " + localStorage.getItem(z9EEEE.n) },
                data: { itemsPerPage: p9 },
                success: function(d9) {
                    $.ajax({
                        type: "GET",
                        url: z9EEEE.d + E9 + "/management/racks",
                        headers: { "Authorization": "Bearer " + localStorage.getItem(z9EEEE.n) },
                        data: { itemsPerPage: p9 },
                        success: function(j9) {
                            var w9 = "<select id='freeplacesracks'><option value='all'>Alle</option>";
                            $.each(j9.entries, function() {
                                w9 = w9 + "<option value='" + this.id + "'>" + this.name + "</option>";
                                $.ajax({
                                    type: "GET",
                                    url: z9EEEE.d + E9 + "/management/racks/" + this.id + "/shelves",
                                    headers: { "Authorization": "Bearer " + localStorage.getItem(z9EEEE.n) },
                                    data: { itemsPerPage: p9 },
                                    success: function(n9) {
                                        $.each(n9.entries, function() {
                                            shelves[this.id] = new Object();
                                            shelves[this.id] = this;
                                        });
                                    }
                                });
                            });
                            w9 = w9 + "</select><script>$(document).ready(function(){$('#freeplacesracks').change( function(){changeregal($(this).val());});});</script>";
                            $('#rackselect').html(w9);
                            alert("Berechnung erfolgreich.");
                            $('.btn').removeAttr("disabled");
                        }
                    });
                    $.each(d9.entries, function() {
                        places[this.id] = new Object();
                        places[this.id] = { name: this.name, type: this.type, rack: this.rackId, shelf: this.shelfId };
                    });
                    $.each(places, function(W9, y9) {
                        if (typeof filledplaces[W9] != "undefined") {} else {
                            freeplaces[W9] = new Object();
                            freeplaces[W9] = y9;
                        }
                    });
                }
            });
        }
    });
}

function changeregal(Q9) {
    var q9 = "<select id='shelvselects' ><option value='all'>Alle</option>";
    $.each(shelves, function() { if (this.rackId == Q9) { q9 = q9 + "<option value='" + this.id + "'>" + this.name + "</option>"; } });
    q9 = q9 + "</select>";
    $('#shelvselect').html(q9);
}

function getwarehouses() {
    var P9 = "";
    $.ajax({
        async: false,
        type: "GET",
        url: "/rest/stockmanagement/warehouses",
        headers: { "Authorization": "Bearer " + localStorage.getItem(z9EEEE.n) },
        success: function(g9) {
            var a9 = "<select id='freeplaceswarehouses'>";
            $.each(g9, function() { a9 = a9 + "<option value='" + this.id + "'>" + this.name + "</option>"; });
            a9 = a9 + "</select>";
            $('#warehousesselect').html(a9);
        },
        error: function(H9) {}
    });
}

function returnfreeplaces(o9 = "0") {
    var l9 = '#freeplacesausgabe';
    if (Object.keys(places).length > 0) {
        var m9 = $('#freeplaceslimit').val();
        var e9 = $('#freeplacestype').val();
        var L9 = $('#freeplacesracks').val();
        var G9 = $('#shelvselects').val();
        var Y9 = 0;
        var r9 = 0;
        var O9 = "<table class='table table-striped table-bordered'><th>storageLocationId</th><th>storageLocationName</th>";
        var v9 = new Object();
        $.each(freeplaces, function(f9, x9) {
            var S9 = "</td></tr>";
            var J9 = "</td><td>";
            var N9 = "all";
            if (Y9 == m9) { return false; }
            if (L9 == N9 && G9 == N9 && e9 == N9) {
                Y9++;
                r9++;
                O9 = O9 + "<tr><td>" + f9 + J9 + x9.name + S9;
                v9[r9] = new Object();
                v9[r9] = [f9, x9.name];
            } else if (L9 == N9 && G9 == N9 && e9 != N9) {
                if (x9.type == e9) {
                    Y9++;
                    r9++;
                    O9 = O9 + "<tr><td>" + f9 + J9 + x9.name + S9;
                    v9[r9] = new Object();
                    v9[r9] = [f9, x9.name];
                }
            } else if (L9 == N9 && G9 != N9 && e9 == N9) {
                if (x9.shelf == G9) {
                    Y9++;
                    r9++;
                    O9 = O9 + "<tr><td>" + f9 + J9 + x9.name + S9;
                    v9[r9] = new Object();
                    v9[r9] = [f9, x9.name];
                }
            } else if (L9 != N9 && G9 == N9 && e9 == N9) {
                if (x9.rack == L9) {
                    Y9++;
                    r9++;
                    O9 = O9 + "<tr><td>" + f9 + J9 + x9.name + S9;
                    v9[r9] = new Object();
                    v9[r9] = [f9, x9.name];
                }
            } else if (L9 == N9 && G9 != N9 && e9 != N9) {
                if (x9.shelf == G9 && x9.type == e9) {
                    Y9++;
                    r9++;
                    O9 = O9 + "<tr><td>" + f9 + J9 + x9.name + S9;
                    v9[r9] = new Object();
                    v9[r9] = [f9, x9.name];
                }
            } else if (L9 != N9 && G9 != N9 && e9 == N9) {
                if (x9.shelf == G9 && x9.rack == L9) {
                    Y9++;
                    r9++;
                    O9 = O9 + "<tr><td>" + f9 + J9 + x9.name + S9;
                    v9[r9] = new Object();
                    v9[r9] = [f9, x9.name];
                }
            } else if (L9 != N9 && G9 == N9 && e9 != N9) {
                if (x9.rack == L9 && x9.type == e9) {
                    Y9++;
                    r9++;
                    O9 = O9 + "<tr><td>" + f9 + J9 + x9.name + S9;
                    v9[r9] = new Object();
                    v9[r9] = [f9, x9.name];
                }
            } else if (L9 != N9 && G9 != N9 && e9 != N9) {
                if (x9.shelf == G9 && x9.rack == L9 && x9.type == e9) {
                    Y9++;
                    r9++;
                    O9 = O9 + "<tr><td>" + f9 + J9 + x9.name + S9;
                    v9[r9] = new Object();
                    v9[r9] = [f9, x9.name];
                }
            }
        });
        O9 = O9 + "</table>";
        if (o9 == "0") { if (r9 > 0) { $(l9).html(O9); } else { $(l9).html("<hr><p style='color: red;'>Keine Lagerorte gefunden.</p>"); } }
        return v9;
    } else { alert("Bitte berechnen Sie zuerst Ihre freien Lagerorte"); }
}

function togglefreielagerorte() { $('#freeplacesdialog').dialog("open"); }

function deletefreeplace(c9) {
    delete freeplaces[c9];
    returnfreeplaces();
}
$(document).ready(function() {
    var R9 = '.ueberschnittmessage';
    var T9 = '.warehousecheckbox';
    var B9 = '#error_body';
    getwarehouses();
    $(document).ajaxStart(function() {
        $(B9).html("");
        $('#load').modal('show');
    }).ajaxStop(function() { $('#load').modal('hide'); }).ajaxError(function(k9) {
        var D9 = $.parseJSON(k9.responseText);
        $(B9).append("<div class='find-false'><p>ErrorCode: " + D9.error.code + " <br/> Message: " + D9.error.message + "</p></div>");
        $('#error_modal').modal('show');
    });
    $(T9).change(function() {
        var i9 = ":disabled";
        $(T9).each(function() {
            var Z9 = 0;
            if ($(this).is(":checked")) { Z9 = 1; }
            warehouses[$(this).attr('whid')] = new Object();
            warehouses[$(this).attr('whid')] = Z9;
        });
        if ($('.findarticle').is(i9) && $('#menu_var').text() == "umbuchen" && $('.locationean').is(i9)) {
            $('#load').modal('show');
            setTimeout(function() { findPlaces(); }, 20);
        }
    });
    $('#togglemenu').click(function() {
        var V9 = '#freeplacessettings';
        var b9 = "act";
        var F9 = $(this).attr(b9);
        if (F9 == "1") {
            $(V9).fadeOut(100);
            $(this).val("Menü einblenden");
            $(this).attr(b9, "0");
        } else {
            $(V9).fadeIn(100);
            $(this).val("Menü ausblenden");
            $(this).attr(b9, "1");
        }
    });
    $('.menutip').click(function() { window.location = $(this).attr('href'); });
    $('.ueberschnitt').click(function() {
        $(R9).fadeOut(200);
        $(this).fadeOut(200);
    });
    $('.calcfreeplaces').click(function() { getfreeplaces($('#freeplaceswarehouses').val()); });
    $('.showplaces').click(function() { returnfreeplaces(); });
    $('.export').click(function() { exportfreeplaces(); });
    setInterval(function() {
        var M9 = "pins";
        var C9 = '#loadingpins';
        var K9 = $(C9).attr(M9);
        switch (K9) {
            case "0":
                $(C9).text(".");
                $(C9).attr(M9, "1");
                break;
            case "1":
                $(C9).text("..");
                $(C9).attr(M9, "2");
                break;
            case "2":
                $(C9).text("...");
                $(C9).attr(M9, "3");
                break;
            case "3":
                $(C9).text("....");
                $(C9).attr(M9, "0");
                break;
        }
    }, 500);
    setTimeout(function() { $(R9).fadeOut(250); }, 7500);
});